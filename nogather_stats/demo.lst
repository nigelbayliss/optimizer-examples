SQL> @demo
SQL> set linesize 150
SQL> set tab off
SQL> set pagesize 1000
SQL> column plan_table_output format a140
SQL> 
SQL> drop table t1 purge;

Table dropped.

SQL> 
SQL> create table t1 (id number, v1 number, v2 number, v3 number, v4 number, v5 number, t varchar2(100));

Table created.

SQL> 
SQL> begin
  2    for i in 1..100000
  3    loop
  4       insert into t1 values (i,mod(i,5000),mod(i,5000),mod(i,5000),mod(i,5000),mod(i,5000),'XXXXXXXXXXXXXXXXXXXX');
  5    end loop;
  6  end;
  7  /

PL/SQL procedure successfully completed.

SQL> commit;

Commit complete.

SQL> 
SQL> create index t1i on t1 (v1,v3,v4);

Index created.

SQL> create index t2i on t1 (v1,v2,v3,v4,t);

Index created.

SQL> 
SQL> exec dbms_stats.gather_table_stats(user,'t1')

PL/SQL procedure successfully completed.

SQL> 
SQL> var bind1 number
SQL> var bind2 number
SQL> 
SQL> exec :bind1 := 1

PL/SQL procedure successfully completed.

SQL> exec :bind2 := 1

PL/SQL procedure successfully completed.

SQL> 
SQL> select /*+ gather_plan_statistics */ /* EG1 */ sum(v5) from t1 where v1 = 1 and v2 = 1;

   SUM(V5)                                                                                                                                            
----------                                                                                                                                            
        20                                                                                                                                            

SQL> --
SQL> -- Observe below that the cardinality estimate is accurate. In other words A-Rows equals E-Rows.
SQL> -- Note also that index T1I is used
SQL> --
SQL> SELECT * FROM table(DBMS_XPLAN.DISPLAY_CURSOR(FORMAT=>'ALLSTATS LAST'));

PLAN_TABLE_OUTPUT                                                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------          
SQL_ID  503wkmu9au06z, child number 0                                                                                                                 
-------------------------------------                                                                                                                 
select /*+ gather_plan_statistics */ /* EG1 */ sum(v5) from t1 where v1                                                                               
= 1 and v2 = 1                                                                                                                                        
                                                                                                                                                      
Plan hash value: 3706417023                                                                                                                           
                                                                                                                                                      
-------------------------------------------------------------------------------------------------------                                               
| Id  | Operation                            | Name | Starts | E-Rows | A-Rows |   A-Time   | Buffers |                                               
-------------------------------------------------------------------------------------------------------                                               
|   0 | SELECT STATEMENT                     |      |      1 |        |      1 |00:00:00.01 |      22 |                                               
|   1 |  SORT AGGREGATE                      |      |      1 |      1 |      1 |00:00:00.01 |      22 |                                               
|*  2 |   TABLE ACCESS BY INDEX ROWID BATCHED| T1   |      1 |     20 |     20 |00:00:00.01 |      22 |                                               
|*  3 |    INDEX RANGE SCAN                  | T1I  |      1 |     20 |     20 |00:00:00.01 |       2 |                                               
-------------------------------------------------------------------------------------------------------                                               
                                                                                                                                                      
Predicate Information (identified by operation id):                                                                                                   
---------------------------------------------------                                                                                                   
                                                                                                                                                      
   2 - filter("V2"=1)                                                                                                                                 
   3 - access("V1"=1)                                                                                                                                 
                                                                                                                                                      

22 rows selected.

SQL> 
SQL> --
SQL> -- We add new data to the database
SQL> --
SQL> begin
  2    for i in 1..10000
  3    loop
  4       insert into t1 values (i,mod(i,5),10000,mod(i,5000),mod(i,5000),mod(i,5000),'XXXXXXXXXXXXXXXXXXXX');
  5    end loop;
  6  end;
  7  /

PL/SQL procedure successfully completed.

SQL> commit;

Commit complete.

SQL> 
SQL> --
SQL> -- The application now expects the value 10000 to be in the database
SQL> -- so we'll change the bind value to retrieve the rows we know to be there
SQL> --
SQL> -- Note that we have not regathered statstics - they are unchanged
SQL> -- In other words, "nothing has changed" other than the data in the database
SQL> -- and the values we are retrieving.
SQL> --
SQL> exec :bind2 := 10000

PL/SQL procedure successfully completed.

SQL> 
SQL> select /*+ gather_plan_statistics */ /* EG2 */ sum(v5) from t1 where v1 = 1 and v2 = 10000;

   SUM(V5)                                                                                                                                            
----------                                                                                                                                            
   4997000                                                                                                                                            

SQL> --
SQL> -- Observe below that the cardinality estimate is NOT accurate. In other words A-Rows doesn't equal E-Rows.
SQL> -- Note that the plan has changed: index T2I is now used instead of T1I
SQL> --
SQL> SELECT * FROM table(DBMS_XPLAN.DISPLAY_CURSOR(FORMAT=>'ALLSTATS LAST'));

PLAN_TABLE_OUTPUT                                                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------          
SQL_ID  7pgxjba36v0hr, child number 5                                                                                                                 
-------------------------------------                                                                                                                 
select /*+ gather_plan_statistics */ /* EG2 */ sum(v5) from t1 where v1                                                                               
= 1 and v2 = 10000                                                                                                                                    
                                                                                                                                                      
Plan hash value: 3966659796                                                                                                                           
                                                                                                                                                      
-------------------------------------------------------------------------------------------------------                                               
| Id  | Operation                            | Name | Starts | E-Rows | A-Rows |   A-Time   | Buffers |                                               
-------------------------------------------------------------------------------------------------------                                               
|   0 | SELECT STATEMENT                     |      |      1 |        |      1 |00:00:00.01 |    2023 |                                               
|   1 |  SORT AGGREGATE                      |      |      1 |      1 |      1 |00:00:00.01 |    2023 |                                               
|   2 |   TABLE ACCESS BY INDEX ROWID BATCHED| T1   |      1 |      1 |   2000 |00:00:00.01 |    2023 |                                               
|*  3 |    INDEX RANGE SCAN                  | T2I  |      1 |      1 |   2000 |00:00:00.01 |      23 |                                               
-------------------------------------------------------------------------------------------------------                                               
                                                                                                                                                      
Predicate Information (identified by operation id):                                                                                                   
---------------------------------------------------                                                                                                   
                                                                                                                                                      
   3 - access("V1"=1 AND "V2"=10000)                                                                                                                  
                                                                                                                                                      

21 rows selected.

SQL> spool off
